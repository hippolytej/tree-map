(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{110:function(e,t,a){e.exports=a(278)},115:function(e,t,a){},278:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(22),i=a.n(o),s=a(280),c=a(282),l=a(281),u=(a(115),a(16)),d=a(17),h=a(19),p=a(18),m=a(26),f=a(20),b=(a(54),a(25)),g=a(51),v=a.n(g),y=a(279);var k=Object(b.withStyles)(function(e){return{button:{margin:5}}})(function(e){var t=e.classes;return r.a.createElement("div",null,r.a.createElement(v.a,{size:"small",variant:e.variant,className:t.button,component:e.to?y.a:void 0,to:e.to,href:e.href},e.text))}),w=a(104),D=a.n(w),E=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(h.a)(this,Object(p.a)(t).call(this,e))).handleChange=a.handleChange.bind(Object(m.a)(a)),a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"handleChange",value:function(e){var t=e.target.value;this.props.onChange(t)}},{key:"render",value:function(){var e=this.props.classes;return r.a.createElement("form",{className:e.root,noValidate:!0,autoComplete:"off"},r.a.createElement(D.a,{id:"address-basic",label:"Address",onChange:this.handleChange,value:this.props.value}))}}]),t}(r.a.Component),j=Object(b.withStyles)(function(e){return{button:{margin:5}}})(E),C=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(h.a)(this,Object(p.a)(t).call(this,e))).state={address:""},a.handleAddressChange=a.handleAddressChange.bind(Object(m.a)(a)),a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"handleAddressChange",value:function(e){this.setState({address:e})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("header",null,r.a.createElement("img",{src:"/logo_canopee_v0.001.png",alt:"logo",height:"200"}),r.a.createElement("h1",null,"canopee"),r.a.createElement("p",null,"Votre guide arboricole")),r.a.createElement("main",null,r.a.createElement(k,{text:"Explorez",variant:"outlined",to:"/explore"}),r.a.createElement(k,{text:"Autour de vous",variant:"outlined",to:{pathname:"/around-me",state:this.state}}),r.a.createElement(j,{onChange:this.handleAddressChange,value:this.state.address})),r.a.createElement("footer",null,r.a.createElement(k,{className:"inner",text:"Code",href:"https://github.com/hippolytej/tree-map"}),r.a.createElement(k,{text:"Coolitude",href:"https://www.arbres.org/actualite.html"}),r.a.createElement(k,{text:"Data",href:"https://opendata.paris.fr/explore/dataset/les-arbres/information/"})))}}]),t}(n.Component),T=a(29),O=a(12),I=function(e){function t(){return Object(u.a)(this,t),Object(h.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this,t=this.props.treeIds,a=this.props.treeDict;return r.a.createElement(T.b,{type:"symbol",id:"trees",layout:{"icon-image":"billy"}},t.map(function(t){return r.a.createElement(T.a,{onMouseEnter:e.props.onTreeHover.bind(e,t),onMouseLeave:e.props.onTreeEndHover.bind(e),coordinates:a[t].geometry.coordinates,onClick:e.props.onTreeClick.bind(null,t),key:t})}))}}]),t}(n.Component);var x=Object(b.withStyles)(function(e){return{button:{margin:5}}})(function(e){var t=e.classes;return r.a.createElement("div",null,r.a.createElement(v.a,{size:"small",variant:"outlined",className:t.button,onClick:e.onClick},e.text))}),S=a(28),B=function(e){function t(){return Object(u.a)(this,t),Object(h.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props.hoveredTree,t=this.props.onCloseButtonClick,a=this.props.onInfoButtonClick,n=this.props.isClicked,o=e.geometry.coordinates[0],i=e.geometry.coordinates[1],s="https://citymapper.com/directions?endcoord=".concat(i,"%2C").concat(o,"&endname=Arbre%20Remarquable");return r.a.createElement(T.c,{key:e.recordid,coordinates:e.geometry.coordinates,offset:15},r.a.createElement("div",{style:{overflowX:"auto"}},r.a.createElement("h3",{style:{fontFamily:"Roboto",fontSize:14,marginTop:5,marginBottom:5}},e.fields.libellefrancais),r.a.createElement("table",{style:{width:"100%"}},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",{style:{fontFamily:"Roboto",fontSize:14,fontWeight:"medium"}},"Genre"),r.a.createElement("td",{style:{fontFamily:"Roboto",fontSize:14,textAlign:"right"}},e.fields.genre)),r.a.createElement("tr",null,r.a.createElement("td",{style:{fontFamily:"Roboto",fontSize:14,fontWeight:"medium"}},"Esp\xe8ce"),r.a.createElement("td",{style:{fontFamily:"Roboto",fontSize:14,textAlign:"right"}},e.fields.espece)),"dateplantation"in e.fields?r.a.createElement("tr",null,r.a.createElement("td",{style:{fontFamily:"Roboto",fontSize:14,fontWeight:"medium"}},"Plant\xe9 en"),r.a.createElement("td",{style:{fontFamily:"Roboto",fontSize:14,textAlign:"right"}},e.fields.dateplantation.substr(0,4))):null)),n||S.isMobile?r.a.createElement("div",{style:{marginLeft:"auto",marginRight:"auto"}},r.a.createElement("a",{href:s,target:"_blank",rel:"noopener noreferrer"},r.a.createElement("img",{src:"https://static.citymapper.com/img/embed/GetMeThere_Citymapper.png",alt:"Get directions with Citymapper"})),r.a.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center"}},r.a.createElement(x,{onClick:a,text:"Infos"}),r.a.createElement(x,{onClick:t,text:"Fermer"}))):null))}}]),t}(n.Component),A=a(107),L=a.n(A),H=a(106),z=a.n(H);var U=Object(b.withStyles)(function(e){return{progress:{margin:2*e.spacing.unit}}})(function(e){var t=e.classes;return r.a.createElement("div",null,r.a.createElement(z.a,{className:t.progress,color:"secondary"}))}),M=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(h.a)(this,Object(p.a)(t).call(this,e))).state={imageLoaded:!1},a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"handleImageLoaded",value:function(){this.setState({imageLoaded:!0}),console.log("LOADED",this.state)}},{key:"handleImageErrored",value:function(){this.setState({imageLoaded:!1})}},{key:"render",value:function(){var e=this.state.imageLoaded,t=this.props.imageUrl;return r.a.createElement("div",null,r.a.createElement("img",{src:t,onLoad:this.handleImageLoaded.bind(this),onError:this.handleImageErrored.bind(this),alt:""}),e?null:r.a.createElement(U,null))}}]),t}(r.a.Component),q=function(e){function t(){return Object(u.a)(this,t),Object(h.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props.classes,t=this.props.treeName;return r.a.createElement("div",null,r.a.createElement(L.a,{anchor:S.isMobile?"bottom":"left",open:this.props.openDrawer,onClose:this.props.toggleDrawer},r.a.createElement("div",{style:{width:S.isMobile?"auto":350},tabIndex:0,role:"button",onClick:this.props.toggleDrawer,onKeyDown:this.props.toggleDrawer},r.a.createElement("div",{className:e.wikiRow},t,r.a.createElement(M,{imageUrl:this.props.thumbnailUrl,altText:t})),r.a.createElement("div",{className:e.wikiTextContainer},r.a.createElement("p",null,this.props.wikiDesc)))))}}]),t}(r.a.Component),N=Object(b.withStyles)({list:{width:250},fullList:{width:"auto"},treeImg:{marginTop:10,marginBottom:10,marginRight:10,width:100,display:"inlineBlock",float:"left"},wikiRow:{marginLeft:10,marginRight:10},wikiTextContainer:{marginLeft:10,marginRight:10}})(q),R=a(33),F=a(27),G=a.n(F),J=a(32);function W(e){return _.apply(this,arguments)}function _(){return(_=Object(J.a)(G.a.mark(function e(t){var a,n,r,o,i,s,c,l,u,d,h,p,m;return G.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.split(" ").join("_"),console.log("Safe Keyword: ",a),n="https://fr.wikipedia.org/w/api.php?format=json&origin=*",r="",o=0,e.prev=5,e.next=8,fetch("".concat(n,"&action=query&list=search&srsearch=").concat(a));case 8:return i=e.sent,e.next=11,i.json();case 11:return s=e.sent,console.log("Search response Json",s),e.next=15,s.query.search[0].title;case 15:return r=e.sent,e.next=18,s.query.search[0].pageid;case 18:o=e.sent,console.log("Best result",r),e.next=25;break;case 22:e.prev=22,e.t0=e.catch(5),console.log("search error",e.t0);case 25:return c="",e.prev=26,e.next=29,fetch("".concat(n,"&action=query&prop=extracts&exintro&explaintext&redirects=1&titles=").concat(r));case 29:return l=e.sent,e.next=32,l.json();case 32:return u=e.sent,console.log("descQuery Json",u),e.next=36,u.query.pages;case 36:return d=e.sent,console.log("Pages",d),e.next=40,d[Object.keys(d)[0]].extract;case 40:c=e.sent,e.next=46;break;case 43:e.prev=43,e.t1=e.catch(26),console.log("desc error",e.t1);case 46:return h="",e.prev=47,e.next=50,fetch("".concat(n,"&action=query&prop=pageimages&titles=").concat(r,"&pithumbsize=200"));case 50:return p=e.sent,e.next=53,p.json();case 53:return m=e.sent,console.log("thumbQuery Json",m),e.next=57,m.query.pages[o].thumbnail.source;case 57:h=e.sent,console.log("Thumbnail",h),e.next=64;break;case 61:e.prev=61,e.t2=e.catch(47),console.log("thumbnail error",e.t2);case 64:return e.abrupt("return",this.setState({wikiDesc:c,thumbnailUrl:h},function(){console.log("wikiData",this.state.thumbnailUrl)}));case 65:case"end":return e.stop()}},e,this,[[5,22],[26,43],[47,61]])}))).apply(this,arguments)}function Z(){return(Z=Object(J.a)(G.a.mark(function e(){var t,a,n,r,o;return G.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,fetch("https://opendata.paris.fr/api/records/1.0/search/?dataset=arbresremarquablesparis&rows=200");case 3:return a=e.sent,e.next=6,a.json();case 6:for(n=e.sent,r=Math.min(n.parameters.rows,n.nhits),o=0;o<r;o++)t.push(o);return e.abrupt("return",this.setState({treeDict:n.records,nbTrees:r,treeIds:t},function(){console.log("nb loaded trees",this.state.nbTrees)}));case 10:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function P(e,t,a){return V.apply(this,arguments)}function V(){return(V=Object(J.a)(G.a.mark(function e(t,a,n){var r,o,i,s,c;return G.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("api call lat",t),console.log("api call long",a),r=[],"https://opendata.paris.fr/api/records/1.0/search/?dataset=les-arbres&q=&facet=typeemplacement&facet=domanialite&facet=arrondissement&facet=libellefrancais&facet=genre&facet=espece&facet=varieteoucultivar&facet=circonferenceencm&facet=hauteurenm&facet=stadedeveloppement&facet=remarquable&geofilter.distance=",e.next=6,fetch("".concat("https://opendata.paris.fr/api/records/1.0/search/?dataset=les-arbres&q=&facet=typeemplacement&facet=domanialite&facet=arrondissement&facet=libellefrancais&facet=genre&facet=espece&facet=varieteoucultivar&facet=circonferenceencm&facet=hauteurenm&facet=stadedeveloppement&facet=remarquable&geofilter.distance=").concat(t,"%2C").concat(a,"%2C").concat(n,"&rows=200"));case 6:return o=e.sent,e.next=9,o.json();case 9:for(i=e.sent,s=Math.min(i.parameters.rows,i.nhits),c=0;c<s;c++)r.push(c);return e.abrupt("return",this.setState({treeDict:i.records,nbTrees:s,treeIds:r},function(){console.log("nb loaded trees",this.state.nbTrees)}));case 13:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var K=Object(T.d)({minZoom:11,maxZoom:16,accessToken:R.b}),X=R.a,Y={speed:.6},Q=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(h.a)(this,Object(p.a)(t).call(this,e))).onMapLoad=function(e){e.addControl(new O.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!1}))},a.onTreeHover=function(e,t){t.map.getCanvas().style.cursor="pointer",a.setState({hoveredTreeID:a.state.clickedTreeID||0===a.state.clickedTreeID?"":e}),S.isMobile&&a.setState({clickedTreeID:e})},a.onTreeEndHover=function(e){e.map.getCanvas().style.cursor="",a.setState({hoveredTreeID:""})},a.onTreeClick=function(e){a.setState({hoveredTreeID:e,clickedTreeID:e})},a.onInfoButtonClick=function(){a.setState({openDrawer:!0});var e=a.state.hoveredTreeID?a.state.hoveredTreeID:a.state.clickedTreeID,t=a.state.treeDict[e].fields.libellefrancais,n=a.state.treeDict[e].fields.genre+"_"+a.state.treeDict[e].fields.espece;a.wikiTreeData(n),a.setState({clickedTreeName:t})},a.onCloseButtonClick=function(){a.setState({hoveredTreeID:"",clickedTreeID:""})},a.toggleDrawer=function(){a.setState({openDrawer:!1,thumbnailUrl:"",wikiDesc:""})},a.state={treeDict:"",nbTrees:0,treeIds:[],hoveredTreeID:"",clickedTreeID:"",clickedTreeName:"",mapCenter:[2.3466110229492188,48.85613168160397],zoom:[12],openDrawer:!1,wikiTreeData:"",thumbnailUrl:"",wikiDesc:""},a.toggleDrawer=a.toggleDrawer.bind(Object(m.a)(a)),a.onInfoButtonClick=a.onInfoButtonClick.bind(Object(m.a)(a)),a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.treeData()}},{key:"treeData",value:function(){(function(){return Z.apply(this,arguments)}).apply(this)}},{key:"wikiTreeData",value:function(){W.apply(this,arguments)}},{key:"render",value:function(){var e=this.state.hoveredTreeID,t=this.state.clickedTreeID,a=this.state.mapCenter,n=this.state.zoom;return r.a.createElement("div",null,r.a.createElement(K,{onStyleLoad:this.onMapLoad,style:X,center:a,containerStyle:{width:"100vw",height:"100vh"},flyToOptions:Y,zoom:n},r.a.createElement(k,{text:"Accueil",variant:"outlined",to:"/"},"Home"),r.a.createElement(I,{onTreeHover:this.onTreeHover,onTreeEndHover:this.onTreeEndHover,treeIds:this.state.treeIds,treeDict:this.state.treeDict,onTreeClick:this.onTreeClick}),(e||t||0===e||0===t)&&r.a.createElement(B,{isClicked:t||0===t?1:0,hoveredTree:this.state.treeDict[e||0===e?e:t],onCloseButtonClick:this.onCloseButtonClick,onInfoButtonClick:this.onInfoButtonClick})),r.a.createElement(N,{wikiDesc:this.state.wikiDesc,thumbnailUrl:this.state.thumbnailUrl,treeName:this.state.clickedTreeName,leftDrawer:this.state.leftDrawer,openDrawer:this.state.openDrawer,toggleDrawer:this.toggleDrawer}))}}]),t}(n.Component),$=function(e){function t(){return Object(u.a)(this,t),Object(h.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(N,null),r.a.createElement(Q,null))}}]),t}(n.Component);function ee(){return(ee=Object(J.a)(G.a.mark(function e(t,a){var n,r;return G.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://api.mapbox.com/geocoding/v5/mapbox.places/".concat(t,".json?access_token=").concat(a));case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,e.abrupt("return",this.setState({longitude:r.features[0].center[0],latitude:r.features[0].center[1],locationAvailable:!0}));case 7:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var te=Object(T.d)({minZoom:11,maxZoom:20,accessToken:R.b}),ae=R.a,ne=500,re={speed:0},oe=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(h.a)(this,Object(p.a)(t).call(this,e))).locationFound=function(e){a.setState({longitude:e.coords.longitude,latitude:e.coords.latitude,locationAvailable:!0},function(){P.apply(Object(m.a)(a),[a.state.latitude,a.state.longitude,ne])})},a.errorHandler=function(e){1===e.code?alert("Error: Access is denied!"):2===e.code&&alert("Error: Position is unavailable!")},a.onTreeHover=function(e,t){t.map.getCanvas().style.cursor="pointer",a.setState({hoveredTreeID:a.state.clickedTreeID||0===a.state.clickedTreeID?"":e}),S.isMobile&&a.setState({clickedTreeID:e})},a.onTreeEndHover=function(e){e.map.getCanvas().style.cursor="",a.setState({hoveredTreeID:""})},a.onTreeClick=function(e){a.setState({hoveredTreeID:e,clickedTreeID:e})},a.onInfoButtonClick=function(){console.log("CLICKED"),a.setState({openDrawer:!0});var e=a.state.hoveredTreeID?a.state.hoveredTreeID:a.state.clickedTreeID,t=a.state.treeDict[e].fields.genre+"_"+a.state.treeDict[e].fields.espece;a.wikiTreeData(t)},a.onCloseButtonClick=function(){a.setState({hoveredTreeID:"",clickedTreeID:""})},a.toggleDrawer=function(){a.setState({openDrawer:!1,thumbnailUrl:"",wikiDesc:""})},a.state={locationAvailable:!1,treeDict:"",nbTrees:0,treeIds:[],hoveredTreeID:"",clickedTreeID:"",address:a.props.location.state?a.props.location.state.address:"",latitude:0,longitude:0,zoom:[17],openDrawer:!1,wikiTreeData:"",thumbnailUrl:"",wikiDesc:""},a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"getUserPosition",value:function(){var e=this;if(console.log("CALLED WITH ",this.state),this.state.address)(function(e,t){return ee.apply(this,arguments)}).apply(this,[this.state.address,R.b]).then(function(){P.apply(e,[e.state.latitude,e.state.longitude,ne])});else if(navigator.geolocation){navigator.geolocation.getCurrentPosition(this.locationFound,this.errorHandler,{timeout:6e4})}else alert("Sorry, browser does not support geolocation and no address was supplied")}},{key:"componentDidMount",value:function(){this.state.locationAvailable?P.apply(this,[this.state.latitude,this.state.longitude,ne]):this.getUserPosition.apply(this)}},{key:"wikiTreeData",value:function(){W.apply(this,arguments)}},{key:"render",value:function(){var e=[this.state.longitude,this.state.latitude],t=this.state.zoom,a=this.state.hoveredTreeID,n=this.state.clickedTreeID;return this.state.locationAvailable?r.a.createElement("div",null,r.a.createElement(te,{onStyleLoad:this.onMapLoad,style:ae,center:e,containerStyle:{width:"100vw",height:"100vh"},flyToOptions:re,zoom:t},r.a.createElement(k,{text:"Accueil",variant:"outlined",to:"/"},"Home"),r.a.createElement(I,{onTreeHover:this.onTreeHover,onTreeEndHover:this.onTreeEndHover,treeIds:this.state.treeIds,treeDict:this.state.treeDict,onTreeClick:this.onTreeClick}),(a||n||0===a||0===n)&&r.a.createElement(B,{isClicked:n||0===n?1:0,hoveredTree:this.state.treeDict[a||0===a?a:n],onCloseButtonClick:this.onCloseButtonClick,onInfoButtonClick:this.onInfoButtonClick})),r.a.createElement(N,{wikiDesc:this.state.wikiDesc,thumbnailUrl:this.state.thumbnailUrl,leftDrawer:this.state.leftDrawer,openDrawer:this.state.openDrawer,toggleDrawer:this.toggleDrawer})):r.a.createElement(U,null)}}]),t}(n.Component),ie=function(e){function t(){return Object(u.a)(this,t),Object(h.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"App-header"},r.a.createElement("h1",null,"404")),r.a.createElement("p",null,"Wow c'est la hess ici ou quoi ?"))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var se=r.a.createElement(s.a,null,r.a.createElement("div",null,r.a.createElement(c.a,null,r.a.createElement(l.a,{exact:!0,path:"/",component:C}),r.a.createElement(l.a,{path:"/explore",component:$}),r.a.createElement(l.a,{path:"/around-me",component:oe}),r.a.createElement(l.a,{component:ie}))));i.a.render(se,document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},33:function(e){e.exports={b:"pk.eyJ1IjoiaGlwcG9seXRlaiIsImEiOiJjanhieGMyZWYwNGVyM3BwcjJxdHZ0azBiIn0.EYdUWJXo8YByqTGUyVVqZA",a:"mapbox://styles/hippolytej/cjgnojfg700a02rp30bjdees6"}},54:function(e,t,a){}},[[110,1,2]]]);
//# sourceMappingURL=main.8f7c29df.chunk.js.map