(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{225:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(21),i=n.n(o),c=n(227),l=n(229),s=n(228),u=(n(95),n(8)),m=n(9),p=n(11),h=n(10),d=n(12),f=(n(46),n(226)),b=n(30),g=n(41),y=n.n(g);var v=Object(b.withStyles)(function(e){return{button:{margin:5}}})(function(e){var t=e.classes;return r.a.createElement("div",null,r.a.createElement(y.a,{size:"small",variant:e.variant,className:t.button,component:e.link,href:e.href},e.text))}),E=function(e){return r.a.createElement(f.a,Object.assign({to:"/explore"},e))},k=function(e){return r.a.createElement(f.a,Object.assign({to:"/learn"},e))},w=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("header",null,r.a.createElement("img",{src:"/logo_canopee_v0.001.png",alt:"logo",height:"200"}),r.a.createElement("h1",null,"canopee"),r.a.createElement("p",null,"Votre guide arboricole")),r.a.createElement("main",null,r.a.createElement(v,{text:"Explorez",variant:"outlined",link:E}),r.a.createElement(v,{text:"Apprenez",variant:"outlined",link:k})),r.a.createElement("footer",null,r.a.createElement(v,{className:"inner",text:"Code",link:"a",href:"https://github.com/hippolytej/tree-map"}),r.a.createElement(v,{text:"Coolitude",link:"a",href:"https://www.arbres.org/actualite.html"}),r.a.createElement(v,{text:"Data",link:"a",href:"https://opendata.paris.fr/explore/dataset/les-arbres/information/"})))}}]),t}(a.Component),j=n(33),D=n(25),O=n(4),x=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this,t=this.props.treeIds,n=this.props.treeDict;return r.a.createElement(D.b,{type:"symbol",id:"trees",layout:{"icon-image":"billy"}},t.map(function(t){return r.a.createElement(D.a,{onMouseEnter:e.props.onTreeHover.bind(e,t),onMouseLeave:e.props.onTreeEndHover.bind(e),coordinates:n[t].geometry.coordinates,onClick:e.props.onTreeClick.bind(null,t),key:t})}))}}]),t}(a.Component);var C=Object(b.withStyles)(function(e){return{button:{margin:5}}})(function(e){var t=e.classes;return r.a.createElement("div",null,r.a.createElement(y.a,{size:"small",variant:"outlined",className:t.button,onClick:e.onClick},e.text))}),T=n(24),I=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.props.hoveredTree,t=this.props.onCloseButtonClick,n=this.props.onInfoButtonClick,a=this.props.isClicked,o=e.geometry.coordinates[0],i=e.geometry.coordinates[1],c="https://citymapper.com/directions?endcoord=".concat(i,"%2C").concat(o,"&endname=Arbre%20Remarquable");return r.a.createElement(D.c,{key:e.recordid,coordinates:e.geometry.coordinates,offset:15},r.a.createElement("div",{style:{overflowX:"auto"}},r.a.createElement("h3",{style:{fontFamily:"Roboto",fontSize:14,marginTop:5,marginBottom:5}},e.fields.libellefrancais),r.a.createElement("table",{style:{width:"100%"}},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",{style:{fontFamily:"Roboto",fontSize:14,fontWeight:"medium"}},"Genre"),r.a.createElement("td",{style:{fontFamily:"Roboto",fontSize:14,textAlign:"right"}},e.fields.genre)),r.a.createElement("tr",null,r.a.createElement("td",{style:{fontFamily:"Roboto",fontSize:14,fontWeight:"medium"}},"Esp\xe8ce"),r.a.createElement("td",{style:{fontFamily:"Roboto",fontSize:14,textAlign:"right"}},e.fields.espece)),r.a.createElement("tr",null,r.a.createElement("td",{style:{fontFamily:"Roboto",fontSize:14,fontWeight:"medium"}},"Plant\xe9 en"),r.a.createElement("td",{style:{fontFamily:"Roboto",fontSize:14,textAlign:"right"}},e.fields.dateplantation.substr(0,4))))),a||T.isMobile?r.a.createElement("div",{style:{marginLeft:"auto",marginRight:"auto"}},r.a.createElement("a",{href:c,target:"_blank",rel:"noopener noreferrer"},r.a.createElement("img",{src:"https://static.citymapper.com/img/embed/GetMeThere_Citymapper.png",alt:"Get directions with Citymapper"})),r.a.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center"}},r.a.createElement(C,{onClick:n,text:"Infos"}),r.a.createElement(C,{onClick:t,text:"Fermer"}))):null))}}]),t}(a.Component),S=n(88),B=n.n(S),z=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.props.classes;return r.a.createElement("div",null,r.a.createElement(B.a,{anchor:T.isMobile?"bottom":"left",open:this.props.openDrawer,onClose:this.props.toggleDrawer},r.a.createElement("div",{style:{width:T.isMobile?"auto":350},tabIndex:0,role:"button",onClick:this.props.toggleDrawer,onKeyDown:this.props.toggleDrawer},r.a.createElement("div",{className:e.wikiRow},r.a.createElement("img",{className:e.treeImg,src:this.props.thumbnailUrl,alt:"Wiki Thumbnail"})),r.a.createElement("div",{className:e.wikiTextContainer},r.a.createElement("p",null,this.props.wikiDesc)))))}}]),t}(r.a.Component),R=Object(b.withStyles)({list:{width:250},fullList:{width:"auto"},treeImg:{marginTop:10,marginBottom:10,marginRight:10,width:100,display:"inlineBlock",float:"left"},wikiRow:{marginLeft:10,marginRight:10},wikiTextContainer:{marginLeft:10,marginRight:10}})(z),M=n(60),q=n(31),H=n.n(q),A=n(42);function L(){return(L=Object(A.a)(H.a.mark(function e(t){var n,a,r,o,i,c,l,s,u,m,p,h,d;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.split(" ").join("_"),console.log("Safe Keyword: ",n),a="https://fr.wikipedia.org/w/api.php?format=json&origin=*",r="",o=0,e.prev=5,e.next=8,fetch("".concat(a,"&action=query&list=search&srsearch=").concat(n));case 8:return i=e.sent,e.next=11,i.json();case 11:return c=e.sent,console.log("Search response Json",c),e.next=15,c.query.search[0].title;case 15:return r=e.sent,e.next=18,c.query.search[0].pageid;case 18:o=e.sent,console.log("Best result",r),e.next=25;break;case 22:e.prev=22,e.t0=e.catch(5),console.log("search error",e.t0);case 25:return l="",e.prev=26,e.next=29,fetch("".concat(a,"&action=query&prop=extracts&exintro&explaintext&redirects=1&titles=").concat(r));case 29:return s=e.sent,e.next=32,s.json();case 32:return u=e.sent,console.log("descQuery Json",u),e.next=36,u.query.pages;case 36:return m=e.sent,console.log("Pages",m),e.next=40,m[Object.keys(m)[0]].extract;case 40:l=e.sent,console.log("desc",l),e.next=47;break;case 44:e.prev=44,e.t1=e.catch(26),console.log("desc error",e.t1);case 47:return p="",e.prev=48,e.next=51,fetch("".concat(a,"&action=query&prop=pageimages&titles=").concat(r,"&pithumbsize=200"));case 51:return h=e.sent,e.next=54,h.json();case 54:return d=e.sent,console.log("thumbQuery Json",d),e.next=58,d.query.pages[o].thumbnail.source;case 58:p=e.sent,console.log("Thumbnail",p),e.next=65;break;case 62:e.prev=62,e.t2=e.catch(48),console.log("thumbnail error",e.t2);case 65:return e.abrupt("return",this.setState({wikiDesc:l,thumbnailUrl:p},function(){console.log("wikiData",this.state.thumbnailUrl)}));case 66:case"end":return e.stop()}},e,this,[[5,22],[26,44],[48,62]])}))).apply(this,arguments)}function U(){return(U=Object(A.a)(H.a.mark(function e(){var t,n,a,r,o;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,fetch("https://opendata.paris.fr/api/records/1.0/search/?dataset=arbresremarquablesparis&rows=200");case 3:return n=e.sent,e.next=6,n.json();case 6:for(a=e.sent,r=Math.min(a.parameters.rows,a.nhits),o=0;o<r;o++)t.push(o);return e.abrupt("return",this.setState({treeDict:a.records,nbTrees:r,treeIds:t},function(){console.log("dict",this.state.treeDict),console.log("nb",this.state.nbTrees),console.log("ids",this.state.treeIds)}));case 10:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var G=function(e){return r.a.createElement(f.a,Object.assign({to:"/"},e))},J=Object(D.d)({minZoom:11,maxZoom:16,accessToken:M.b}),N=M.a,W={speed:.6},F=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(h.a)(t).call(this,e))).onMapLoad=function(e){e.addControl(new O.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!1}))},n.onTreeHover=function(e,t){t.map.getCanvas().style.cursor="pointer",n.setState({hoveredTreeID:n.state.clickedTreeID||0===n.state.clickedTreeID?"":e}),T.isMobile&&n.setState({clickedTreeID:e})},n.onTreeEndHover=function(e){e.map.getCanvas().style.cursor="",n.setState({hoveredTreeID:""})},n.onTreeClick=function(e){n.setState({hoveredTreeID:e,clickedTreeID:e})},n.onInfoButtonClick=function(){console.log("CLICKED"),n.setState({openDrawer:!0});var e=n.state.hoveredTreeID?n.state.hoveredTreeID:n.state.clickedTreeID,t=n.state.treeDict[e].fields.genre+"_"+n.state.treeDict[e].fields.espece;n.wikiTreeData(t)},n.onCloseButtonClick=function(){n.setState({hoveredTreeID:"",clickedTreeID:""})},n.toggleDrawer=function(){n.setState({openDrawer:!1,thumbnailUrl:"",wikiDesc:""})},n.state={treeDict:"",nbTrees:0,treeIds:[],hoveredTreeID:"",clickedTreeID:"",mapCenter:[2.3466110229492188,48.85613168160397],zoom:[12],openDrawer:!1,wikiTreeData:"",thumbnailUrl:"",wikiDesc:""},n.toggleDrawer=n.toggleDrawer.bind(Object(j.a)(n)),n.onInfoButtonClick=n.onInfoButtonClick.bind(Object(j.a)(n)),n}return Object(d.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){this.treeData()}},{key:"treeData",value:function(){(function(){return U.apply(this,arguments)}).apply(this)}},{key:"wikiTreeData",value:function(){(function(e){return L.apply(this,arguments)}).apply(this,arguments)}},{key:"render",value:function(){var e=this.state.hoveredTreeID,t=this.state.clickedTreeID,n=this.state.mapCenter,a=this.state.zoom;return console.log("hoveredTreeID",e),console.log("clickedTreeID",t),r.a.createElement("div",null,r.a.createElement(J,{onStyleLoad:this.onMapLoad,style:N,center:n,containerStyle:{width:"100vw",height:"100vh"},flyToOptions:W,zoom:a},r.a.createElement(v,{text:"Accueil",variant:"outlined",link:G},"Home"),r.a.createElement(x,{onTreeHover:this.onTreeHover,onTreeEndHover:this.onTreeEndHover,treeIds:this.state.treeIds,treeDict:this.state.treeDict,onTreeClick:this.onTreeClick}),(e||t||0===e||0===t)&&r.a.createElement(I,{isClicked:t||0===t?1:0,hoveredTree:this.state.treeDict[e||0===e?e:t],onCloseButtonClick:this.onCloseButtonClick,onInfoButtonClick:this.onInfoButtonClick})),r.a.createElement(R,{wikiDesc:this.state.wikiDesc,thumbnailUrl:this.state.thumbnailUrl,leftDrawer:this.state.leftDrawer,openDrawer:this.state.openDrawer,toggleDrawer:this.toggleDrawer}))}}]),t}(a.Component),_=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(R,null),r.a.createElement(F,null))}}]),t}(a.Component),Z=function(e){return r.a.createElement(f.a,Object.assign({to:"/"},e))},V=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("main",null,"Coming soon"),r.a.createElement("footer",null,r.a.createElement(v,{text:"Accueil",variant:"outlined",link:Z},"Home")))}}]),t}(a.Component),K=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"App-header"},r.a.createElement("h1",null,"404")),r.a.createElement("p",null,"Wow c'est la hess ici ou quoi ?"))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var X=r.a.createElement(c.a,null,r.a.createElement("div",null,r.a.createElement(l.a,null,r.a.createElement(s.a,{exact:!0,path:"/",component:w}),r.a.createElement(s.a,{path:"/explore",component:_}),r.a.createElement(s.a,{path:"/learn",component:V}),r.a.createElement(s.a,{component:K}))));i.a.render(X,document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},46:function(e,t,n){},60:function(e){e.exports={b:"pk.eyJ1IjoiaGlwcG9seXRlaiIsImEiOiJjanhieGMyZWYwNGVyM3BwcjJxdHZ0azBiIn0.EYdUWJXo8YByqTGUyVVqZA",a:"mapbox://styles/hippolytej/cjgnojfg700a02rp30bjdees6"}},90:function(e,t,n){e.exports=n(225)},95:function(e,t,n){}},[[90,1,2]]]);
//# sourceMappingURL=main.7588ff25.chunk.js.map